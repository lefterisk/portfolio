"use strict";var console=console||{};angular.module("Portfolio",["ui.router","ngAnimate","ngResource","ngSanitize","ngCookies","ngTouch","angular-loading-bar","ngScrollable","Portfolio.controllers","Portfolio.services","Portfolio.tpls","Portfolio.directives"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"/tpls/home.html",controller:"HomeCtrl"}).state("home.about",{url:"about",views:{about:{templateUrl:"/tpls/about.html",controller:"AboutCtrl"}}}).state("home.work",{url:"work",views:{work:{templateUrl:"/tpls/work.html",controller:"WorkCtrl"}},resolve:{PortfolioItems:["PortfolioItems",function(e){return e()}]}}).state("404",{url:"/404",templateUrl:"/tpls/404.html",controller:"NotFoundCtrl"}),t.otherwise(function(e){var t=e.get("$state");t.go("404",null,{location:!1})})}]).config(["$locationProvider",function(e){e.html5Mode(!0)}]).config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",e.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function(e){var o,n,l,r,a,s,i,c="";for(o in e)if(n=e[o],n instanceof Array){for(i=0;i<n.length;++i)a=n[i],l=o+"["+i+"]",s={},s[l]=a,c+=t(s)+"&";0==n.length&&(c+=encodeURIComponent(o)+"=&")}else if(n instanceof Object)for(r in n)a=n[r],l=o+"["+r+"]",s={},s[l]=a,c+=t(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(o)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}]}]).config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).run(["$rootScope","$state",function(e,t){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){for(var o=t||0,n=this.length;n>o;o++)if(this[o]===e)return o;return-1})}]),angular.module("Portfolio.controllers",[]).controller("HomeCtrl",["$rootScope","$scope","$state","$stateParams","$timeout",function(e,t,o,n,l){e.isWorkState=!1,e.isAboutState=!1,e.$on("$stateChangeSuccess",function(o,n){"home"==n.name?(e.isWorkState=!1,e.isAboutState=!1):("home.about"==n.name||"home.work"==n.name)&&l(function(){t.$broadcast("rebuild:scrollbar")},600)})}]).controller("AboutCtrl",["$rootScope","$scope","$state",function(e,t,o){console.log("About1"),e.isWorkState=!1,e.isAboutState=!0}]).controller("WorkCtrl",["$rootScope","$scope","$state","PortfolioItems",function(e,t,o,n){console.log("Work"),e.isWorkState=!0,e.isAboutState=!1,t.portfolioItems=n.items}]).controller("NotFoundController",["$scope","$state",function(e,t){console.log("NotFound")}]),angular.module("Portfolio.directives",[]).directive("scrollsizescanner",["$window","$timeout",function(e,t){return{restrict:"A",replace:!1,controller:["$scope",function(e){}],link:function(o,n,l){var r=n.find("div")[0],a=l.angle?parseInt(l.angle):0;r=angular.element(r).find("div")[0],t(function(){s()},1e3),angular.element(e).bind("resize",function(){s()}),o.$watch(l.ngShow,function(e,o){e&&t(function(){s()},400)});var s=function(){if(a>0){var t=r.offsetHeight*(a/100);r.offsetHeight+t-40>=e.innerHeight?(n.css({position:"relative",height:e.innerHeight+t-40+"px",top:-t+"px"}),angular.element(r).css({"padding-top":t+"px"})):n.css("height",r.offsetHeight+"px")}else r.offsetHeight-40>=e.innerHeight?n.css("height",e.innerHeight-40+"px"):n.css("height",r.offsetHeight+"px");o.$emit("content.changed")}}}}]),angular.module("Portfolio.services",[]).factory("Portfolio",["$resource",function(e){return e("/data/portfolio.json",{},{get:{method:"GET"}})}]).factory("PortfolioItems",["$q","Portfolio",function(e,t){return function(){var o=e.defer();return t.get(function(e){o.resolve(e)},function(){o.reject("Unable to fetch data")}),o.promise}}]),angular.module("Portfolio.tpls",[]),angular.module("ngScrollable",[]).directive("ngScrollable",["$injector",function(e){var t=e.get("$document"),o=e.get("$interval"),n=e.get("$timeout"),l=e.get("$window"),r=e.get("$parse"),a=angular.bind,s=angular.extend,i=angular.element,c=(angular.isDefined,"undefined"!=typeof l.ontouchstart),u="transform",f=l.requestAnimationFrame||l.webkitRequestAnimationFrame,d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;["webkit","moz","o","ms"].every(function(e){var o=e+"Transform",n=t.find("body").eq(0);return"undefined"!=typeof n[0].style[o]?(u=o,!1):!0});var p={id:0,scrollX:"bottom",scrollY:"right",scrollXSlackSpace:0,scrollYSlackSpace:0,scrollXAlways:!1,scrollYAlways:!1,usePadding:!1,useObserver:!0,wheelSpeed:1,minSliderLength:10,useBothWheelAxes:!1,useKeyboard:!0,preventKeyEvents:!0,updateOnResize:!0,kineticTau:325,spyMargin:1};return{restrict:"A",transclude:!0,template:"<div class=\"scrollable\"><div class=\"scrollable-content\" ng-transclude></div><div class='scrollable-bar scrollable-bar-x'><div class='scrollable-slider'></div></div><div class='scrollable-bar scrollable-bar-y'><div class='scrollable-slider'></div></div></div>",link:function(e,h,m){var g,v,b,y,w,$=s({},p,e.$eval(m.ngScrollable)),k=i(h.children()[0]),C={window:i(l),el:k,content:i(k.children()[0]),barX:i(k.children()[1]),barY:i(k.children()[2]),sliderX:i(i(k.children()[1]).children()[0]),sliderY:i(i(k.children()[2]).children()[0])},X=!1,S=!1,Y=0,A=0,P=0,M=0,x=0,I=0,H=0,T=0,R=0,W=0,O=null,D=null,z=null,E=null,K=!1,U=!1,q=!1,F={},j=0,L=0,N=0,B=0,G=0,J=0,Q=0,V=0,Z=function(e){return e.toFixed(3)+"px"},_=function(e,t,o){return Math.max(t,Math.min(e,o))},ee=function(){var t=e.$root?e.$root.$$phase:e.$$phase;"$apply"!==t&&"$digest"!==t&&e.$digest()},te=function(){var e=Y-3;X?(H=Math.max($.minSliderLength,parseInt(e*e/P,10)),T=parseInt(I*(e-H)/(P-e),10),T>=e-H?T=e-H:0>T&&(T=0),C.sliderX[0].style[u]="translate3d("+Z(T)+",0,0)",C.sliderX[0].style.width=Z(H)):(H=T=0,C.sliderX[0].style[u]="translate3d(0,0,0)",C.sliderX[0].style.width="0")},oe=function(){var e=A-3;S?(R=Math.max($.minSliderLength,parseInt(e*e/M,10)),W=parseInt(x*(e-R)/(M-e),10),W>=e-R?W=e-R:0>W&&(W=0),C.sliderY[0].style[u]="translate3d(0,"+Z(W)+",0)",C.sliderY[0].style.height=Z(R)):(W=R=0,C.sliderY[0].style[u]="translate3d(0,0,0)",C.sliderY[0].style.height="0")},ne=function(){var e=$.scrollXAlways,t={left:0,width:Z(Y),display:X||e?"inherit":"none"};switch($.scrollX){case"bottom":t.bottom=0,C.content[X||e?"addClass":"removeClass"]("scrollable-bottom"),C.barX[X||e?"addClass":"removeClass"]("scrollable-bottom");break;case"top":t.top=0,C.content[X||e?"addClass":"removeClass"]("scrollable-top"),C.barX[X||e?"addClass":"removeClass"]("scrollable-top")}C.barX.css(t),C.sliderX[0].style.display=X?"inherit":"none"},le=function(){var e=$.scrollYAlways,t={top:0,height:Z(A),display:S||e?"inherit":"none"};switch($.scrollY){case"right":t.right=0,C.content[S||e?"addClass":"removeClass"]("scrollable-right"),C.barY[S||e?"addClass":"removeClass"]("scrollable-right");break;case"left":t.left=0,C.content[S||e?"addClass":"removeClass"]("scrollable-left"),C.barY[S||e?"addClass":"removeClass"]("scrollable-left")}C.barY.css(t),C.sliderY[0].style.display=S?"inherit":"none"},re=function(){var t=!1;F.spyX&&(F.spyX(e,parseInt(I,10)),t=!0),F.spyY&&(F.spyY(e,parseInt(x,10)),t=!0),t&&ee()},ae=function(t,o){var n=x,l=I;x=_(o,0,M-A),I=_(t,0,P-Y),C.content[0].style[u]="translate3d("+Z(-I)+","+Z(-x)+",0)",e.$applyAsync(re),A*$.spyMargin>x&&n>=A*$.spyMargin&&e.$broadcast("scrollable.spytop",x,$.id),x>M-A*($.spyMargin+1)&&M-A*($.spyMargin+1)>=n&&e.$broadcast("scrollable.spybottom",x,$.id),Y*$.spyMargin>I&&l>=Y*$.spyMargin&&e.$broadcast("scrollable.spyleft",I,$.id),I>P-Y*($.spyMargin+1)&&P-Y*($.spyMargin+1)>=l&&e.$broadcast("scrollable.spyright",I,$.id)},se=function(e){X&&(ae(e,x),te())},ie=function(e){S&&(ae(I,e),oe())},ce=function(t,o){Y=$.usePadding?C.el[0].clientWidth:C.el[0].offsetWidth,A=$.usePadding?C.el[0].clientHeight:C.el[0].offsetHeight,P=C.content[0].scrollWidth,M=C.content[0].scrollHeight,"none"!==$.scrollX&&P>Y+$.scrollXSlackSpace?X=!0:(se(0),X=!1),"none"!==$.scrollY&&M>A+$.scrollYSlackSpace?S=!0:(ie(0),S=!1),ne(),le(),te(),oe(),I+T+H>P&&se(T),x+W+R>M&&ie(W),o||e.$broadcast("scrollable.dimensions",Y,A,P,M,$.id)},ue=function(e,t){return e.stopPropagation(),t&&e.preventDefault(),!1},fe=function(e){return e=e.originalEvent||e,e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].pageY:e.pageY},de=function(e){return e=e.originalEvent||e,e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].pageX:e.pageX},pe=function(){var e,t,o,n;e=Date.now(),t=e-y,y=e,o=I-N,N=I,n=1e3*o/(1+t),j=.8*n+.2*j,o=x-Q,Q=x,n=1e3*o/(1+t),G=.8*n+.2*G},he=function(){var e,t;L&&(e=Date.now()-y,t=-L*Math.exp(-e/$.kineticTau),t>.5||-.5>t?(se(B+t),f(he)):se(B))},me=function(){var e,t;J&&(e=Date.now()-y,t=-J*Math.exp(-e/$.kineticTau),t>.5||-.5>t?(ie(V+t),f(me)):ie(V))},ge=function(e){return D=de(e),O=I,K=!0,j=L=0,N=I,c||(t.on("mousemove",ve),t.on("mouseup",be)),c&&!w&&(w=o(pe,100)),C.el.addClass("active"),c||ue(e,!0)},ve=function(e){if(K){var t=de(e)-D,o=c?-t:parseInt(t*(P-Y)/(Y-H),10);return f(a(null,se,O+o)),c||ue(e,!0)}},be=function(e){return K&&(c||(t.off("mousemove",ve),t.off("mouseup",be)),K=!1,C.el.removeClass("active"),O=D=null),w&&(o.cancel(w),w=null),(j>10||-10>j)&&(L=.8*j,B=Math.round(I+L),y=Date.now(),f(he)),c||ue(e,!0)},ye=function(e){return E=fe(e),z=x,U=!0,G=J=0,Q=x,c||(t.on("mousemove",we),t.on("mouseup",$e)),c&&!w&&(w=o(pe,100)),C.el.addClass("active"),c||ue(e,!0)},we=function(e){if(U){var t=fe(e)-E,o=c?-t:parseInt(t*(M-A)/(A-R),10);return f(a(null,ie,z+o)),c||ue(e,!0)}},$e=function(e){return U&&(c||(t.off("mousemove",we),t.off("mouseup",$e)),U=!1,C.el.removeClass("active"),z=E=null),w&&(o.cancel(w),w=null),(G>10||-10>G)&&(J=.8*G,V=Math.round(x+J),y=Date.now(),f(me)),c||ue(e,!0)},ke=function(e){var t=parseInt(H/2,10),o=e.clientX-C.barX[0].getBoundingClientRect().left-t,n=Y-H,l=_(o/n,0,1);f(a(null,se,(P-Y)*l))},Ce=function(e){var t=parseInt(R/2,10),o=e.clientY-C.barY[0].getBoundingClientRect().top-t,n=A-R,l=_(o/n,0,1);f(a(null,ie,(M-A)*l))},Xe=function(){q=!0},Se=function(){q=!1},Ye=function(e){var o=0,n=0,l=30;if(!(!q||t[0].activeElement.isContentEditable||"INPUT"===t[0].activeElement.nodeName||e.altKey||e.ctrlKey||e.metaKey)){switch(e.which){case 37:o=-l;break;case 38:n=l;break;case 39:o=l;break;case 40:n=-l;break;case 33:n=A;break;case 32:case 34:n=-A;break;case 35:S&&!X?n=-M:o=A;break;case 36:S&&!X?n=M:o=-A;break;default:return}f(a(null,ie,x-n)),f(a(null,se,I+o)),$.preventKeyEvents&&e.preventDefault()}},Ae=function(){var e=Date.now()-b;500>e?v=n(Ae,500-e):(C.el.removeClass("active"),v=null)},Pe=function(e){e=e.originalEvent||e;var t=e.deltaX*$.wheelSpeed,o=e.deltaY*$.wheelSpeed;b=Date.now(),v||(C.el.addClass("active"),v=n(Ae,500)),$.useBothWheelAxes?S&&!X?f(o?a(null,ie,x+o):a(null,ie,x+t)):X&&!S&&f(t?a(null,se,I+t):a(null,se,I+o)):(f(a(null,ie,x+o)),f(a(null,se,I+t))),ue(e,!0)},Me=function(){if($.useObserver&&d){var e={childList:!0,subtree:!0};g=new d(function(){f(ce)}),g.observe(C.content[0],e)}$.updateOnResize&&C.window.on("resize",ce),"none"!==$.scrollX&&(C.sliderX.on("click",ue),C.barX.on("click",ke),c?(C.el.on("touchstart",ge),C.el.on("touchmove",ve),C.el.on("touchend",be)):C.sliderX.on("mousedown",ge)),"none"!==$.scrollY&&(C.sliderY.on("click",ue),C.barY.on("click",Ce),c?(C.el.on("touchstart",ye),C.el.on("touchmove",we),C.el.on("touchend",$e)):C.sliderY.on("mousedown",ye)),c||C.el.on("wheel",Pe),$.useKeyboard&&!c&&(C.el.on("mouseenter",Xe),C.el.on("mouseleave",Se),t.on("keydown",Ye))},xe=function(){g&&(g.disconnect(),g=null),$.updateOnResize&&C.window.off("resize",ce),C.sliderX.off("click",ue),C.barX.off("click",ke),C.sliderY.off("click",ue),C.barY.off("click",Ce),c?(C.el.off("touchstart",ge),C.el.off("touchmove",ve),C.el.off("touchend",be),C.el.off("touchstart",ye),C.el.off("touchmove",we),C.el.off("touchend",$e)):(C.sliderX.off("mousedown",ge),t.off("mousemove",ve),t.off("mouseup",be),C.sliderY.off("mousedown",ye),t.off("mousemove",we),t.off("mouseup",$e),$.useKeyboard&&(C.el.off("mouseenter",Xe),C.el.off("mouseleave",Se),t.off("keydown",Ye)),C.el.off("wheel",Pe))};e.$on("content.reload",function(e,t){xe(),n(function(){C.el=i(h.children()[0]),C.content=i(C.el.children()[0]),Me(),ce(e,t)})}),e.$on("content.changed",function(e,t,o){t=t||100,n(function(){ce(e,o)},t),e.preventDefault()}),e.$on("scrollable.scroll.left",function(){e.$applyAsync(function(){se(0)})}),e.$on("scrollable.scroll.right",function(){e.$applyAsync(function(){se(P)})}),e.$on("scrollable.scroll.top",function(){e.$applyAsync(function(){ie(0)})}),e.$on("scrollable.scroll.bottom",function(){e.$applyAsync(function(){ie(M)})}),e.$on("$destroy",function(){n.cancel(v),xe()}),Me(),ce(),angular.forEach(["spyX","spyY"],function(t){m[t]&&(F[t]=r(m[t]).assign,e.$watch(m[t],function(e){switch(t){case"spyX":se(e);break;case"spyY":ie(e)}}))})}}}]);